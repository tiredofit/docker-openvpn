#!/command/with-contenv /bin/bash

if [ -z $1 ]; then
	echo '****'
	echo '**** Error! In order to create a client you must enter a client name!'
	echo '****        Example: ovpn_create_client host.example.com'
        exit 1
fi

easyrsa build-client-full $1 nopass
mkdir -p /etc/openvpn/client
ovpn_getclient $1>/etc/openvpn/client/$1.ovpn
if [ "$ENABLE_LDAP" = "TRUE" ] || [ "$ENABLE_LDAP" = "true" ]; then
   echo 'auth-user-pass' >>/etc/openvpn/client/$1.ovpn
fi

echo "**** Client Creation Complete - Distribute /etc/openvpn/client/$1.ovpn to your client"
